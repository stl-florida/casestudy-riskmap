{"version":3,"sources":["app.js","environment.js","main.js","resources/index.js","routes/flood/flood.js","routes/gw/gw.js","routes/riskmap/riskmap.js","routes/storm/storm.js","app.less","resources/styles/themeGuide.less","routes/flood/flood.less","routes/gw/gw.less","routes/riskmap/riskmap.less","routes/storm/storm.less"],"names":["App","configureRouter","config","router","title","options","pushState","root","map","route","name","moduleId","mapUnknownRoutes","redirect","attached","self","debug","testing","configure","aurelia","use","standardConfiguration","feature","developmentLogging","plugin","start","then","setRoot","Flood","RiskMap","EventAggregator","riskmap","ea","subscribe","layer_key","layers","flood","addLayerToMap","detached","id","getLayer","removeLayer","removeSource","Gw","ve","url","paint","ao","ae","ah","x","stormsurge","groundwater","activate","param","risk","layer","addLayer","type","source","layout","visibility","console","log","accessToken","Map","attributionControl","container","center","zoom","style","hash","addControl","NavigationControl","on","flood_key","Storm"],"mappings":"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","file":"app-bundle.js","sourcesContent":["export class App {\n  configureRouter(config, router) {\n    config.title = 'RiskMap';\n    config.options.pushState = true;\n    config.options.root = '/';\n    config.map([\n      {route: ':risk',   name: 'map',  moduleId: 'routes/riskmap/riskmap'}/*,\n      {route: 'stormsurge',   name: 'stormsurge',  moduleId: 'routes/storm/storm'},\n      {route: 'flood',   name: 'flood',  moduleId: 'routes/flood/flood'},\n      {route: 'groundwater',   name: 'groundwater',  moduleId: 'routes/gw/gw'}*/\n    ]);\n    config.mapUnknownRoutes({redirect: 'map'});\n    this.router = router;\n  }\n\n  attached() {\n    var self = this;\n\n  }\n}\n","export default {\n  debug: true,\n  testing: true\n};\n","import environment from './environment';\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","export function configure(config) {\n  //config.globalResources([]);\n}\n","import {inject} from 'aurelia-framework';\nimport {RiskMap} from '../riskmap/riskmap';\nimport {EventAggregator} from 'aurelia-event-aggregator';\n\n//start-aurelia-decorators\n@inject(RiskMap, EventAggregator)\n//end-aurelia-decorators\nexport class Flood {\n\n  constructor(RiskMap, EventAggregator) {\n    this.riskmap = RiskMap;\n    this.ea = EventAggregator;\n  }\n\n  attached() {\n    var self = this;\n    var map = self.riskmap.map;\n\n    self.ea.subscribe('doneLoading', () => {\n      for (let layer_key in self.riskmap.layers.flood) {\n        map.addLayerToMap(flood[layer_key]);\n      }\n    });\n  }\n\n  detached() {\n    var self = this;\n    var map = self.riskmap.map;\n    for (let layer_key in self.riskmap.layers.flood) {\n      var id = self.riskmap.layers.flood[layer_key].id;\n      if (map.getLayer(id)) {\n        map.removeLayer(id);\n        map.removeSource(id);\n      }\n    }\n  }\n}\n","export class Gw {\n\n  constructor() {\n\n  }\n\n  attached() {\n    var self = this;\n\n  }\n}\n","import mapboxgl from 'mapbox-gl';\n\nexport class RiskMap {\n\n  constructor(EventAggregator) {\n    this.ea = EventAggregator;\n\n    this.layers = {\n      flood: {\n        ve: {\n          id: \"FLDHVE\",\n          url: \"b0mn3fbb\",\n          paint: {\n            \"fill-color\": \"#fccf23\",\n            \"fill-opacity\": 0.9\n          }\n        },\n        ao: {\n          id: 'FLDHAO',\n          url: '1eqmjn9o',\n          paint: {\n            \"fill-color\": \"#fc610b\",\n            \"fill-opacity\": 0.8\n          }\n        },\n        ae: {\n          id: 'FLDHAE',\n          url: '4cou1y2j',\n          paint: {\n            \"fill-color\": \"#c44d3f\",\n            \"fill-opacity\": 0.7\n          }\n        },\n        ah: {\n          id: 'FLDHAH',\n          url: '758t0cbw',\n          paint: {\n            \"fill-color\": \"#6576a5\",\n            \"fill-opacity\": 0.5\n          }\n        },\n        x: {\n          id: 'FLDHX',\n          url: '44qg0o2f',\n          paint: {\n            \"fill-color\": \"#368bd8\",\n            \"fill-opacity\": 0.25\n          }\n        }\n      },\n      stormsurge: {\n        id: 'stormsurge',\n        url: '41947bz4',\n        paint: {\n          \"fill-color\": {\n            \"property\": \"CAT\",\n            \"type\": \"categorical\",\n            \"stops\": [\n              [\n                \"1\",\n                \"#c1272d\"\n              ],\n              [\n                \"2\",\n                \"#cd5257\"\n              ],\n              [\n                \"3\",\n                \"#d97d81\"\n              ],\n              [\n                \"4\",\n                \"#e6a8ab\"\n              ],\n              [\n                \"5\",\n                \"#f2d3d5\"\n              ]\n            ]\n          },\n          \"fill-opacity\": {\n            \"property\": \"CAT\",\n            \"type\": \"categorical\",\n            \"stops\": [\n              [\n                \"1\",\n                0.7\n              ],\n              [\n                \"2\",\n                0.6\n              ],\n              [\n                \"3\",\n                0.5\n              ],\n              [\n                \"4\",\n                0.4\n              ],\n              [\n                \"5\",\n                0.3\n              ]\n            ]\n          }\n        }\n      },\n      groundwater: {\n        id: '',\n        url: '',\n        paint: {\n\n        }\n      }\n    };\n  }\n\n  activate(param) {\n    this.risk = param.risk;\n  }\n\n  addLayerToMap(layer) {\n    var self = this;\n    return self.map.addLayer({\n      id: layer.id,\n      type: 'fill',\n      source: {\n        type: 'vector',\n        url: 'mapbox://asbarve.' + layer.url\n      },\n      'source-layer': layer.id,\n      layout: {\n        visibility: 'visible'\n      },\n      paint: layer.paint\n    });\n  }\n\n  attached() {\n    var self = this;\n\n    console.log('DOM ready');\n    console.log(this.risk);\n\n    mapboxgl.accessToken = 'pk.eyJ1IjoiYXNiYXJ2ZSIsImEiOiJjajVvOGdpcmwzejNiMzJvODF2dGFqYWcxIn0.rAJZcytC7dbajv0wzWo8Kw';\n    self.map = new mapboxgl.Map({\n      attributionControl: false,\n      container: 'mapContainer',\n      center: [-80.25, 26.15],\n      zoom: 11,\n      style: 'mapbox://styles/mapbox/light-v9',\n      hash: false\n    });\n\n    self.map.addControl(new mapboxgl.NavigationControl({\n      // TODO: position NOT top-right\n    }));\n\n    self.map.on('load', () => {\n      if (self.risk === 'flood') {\n        for (let layer_key in self.layers.flood) {\n          self.addLayerToMap(self.layers.flood[layer_key]);\n        }\n      } else {\n        self.addLayerToMap(self.layers[self.risk]);\n      }\n    });\n  }\n\n  detached() {\n    var self = this;\n    for (let layer_key in self.layers) {\n      if (layer_key === 'flood') {\n        for (let flood_key in self.layers.flood) {\n          var id = self.layers.flood[flood_key].id;\n          if (self.map.getLayer(id)) {\n            self.map.removeLayer(id);\n            self.map.removeSource(id);\n          }\n        }\n      } else {\n        if (self.map.getLayer(self.layers[layer_key].id)) {\n          self.map.removeLayer(self.layers[layer_key].id);\n          self.map.removeSource(self.layers[layer_key].id);\n        }\n      }\n    }\n  }\n}\n","export class Storm {\n\n  constructor() {\n\n  }\n\n  attached() {\n    var self = this;\n\n  }\n}\n","html, body {\n  width: 100%;\n  height: 100%;\n  margin: 0px;\n  padding: 0px;\n}\n","","@import \"styles/themeGuide.less\";\n","@import \"styles/themeGuide.less\";\n","@import \"styles/themeGuide.less\";\n\n#mapContainer {\n  width: 100%;\n  height: 100%;\n  margin: 0px;\n  padding: 0px;\n}\n","@import \"styles/themeGuide.less\";\n"],"sourceRoot":".."}